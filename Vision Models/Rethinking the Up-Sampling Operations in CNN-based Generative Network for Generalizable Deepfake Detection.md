# Rethinking the Up-Sampling Operations in CNN-based Generative Network for Generalizable Deepfake Detection

### 1. 핵심 주장과 주요 기여

이 논문의 **핵심 주장**은 기존의 딥페이크 검출 연구가 주로 감지 알고리즘 설계에 집중한 반면, **생성기 아키텍처의 업샘플링 작업**에서 비롯된 아티팩트에는 거의 주목하지 않았다는 것입니다. 특히, 논문은 업샘플링 연산자가 주파수 기반 아티팩트를 넘어 **더 일반화 가능한 위조 아티팩트**를 생성할 수 있음을 주장합니다.[1]

**주요 기여**는 다음과 같습니다:[1]

1. **Neighboring Pixel Relationships (NPR)**이라는 새로운 아티팩트 표현 방법 제안 - 이미지 픽셀의 국소적 수준에서 업샘플링으로 인한 아티팩트를 포착하는 방식입니다.[1]

2. 업샘플링 연산자가 전체 이미지 주파수 영역의 영향을 넘어 **국소 픽셀 공간에서 더 나은 일반화 성능**을 제공함을 입증했습니다.[1]

3. 28개의 서로 다른 생성 모델(GAN 16개, 디퓨전 11개, 딥페이크 1개)에 대한 광범위한 실험을 통해 **11.6% 성능 향상**을 달성했습니다.[1]

***

### 2. 문제 정의, 제안 방법, 모델 구조 및 성능

#### 문제 정의

일반화 가능한 딥페이크 검출의 목표는 제한된 훈련 소스로 학습한 감지기가 **이전에 보지 못한 생성 모델**의 위조 이미지도 정확히 식별할 수 있어야 한다는 것입니다. 기존의 주파수 기반 접근법은 GAN의 다양한 주파수 도메인 패턴으로 인해 충분한 일반화를 제공하지 못합니다.[1]

#### 제안 방법: Neighboring Pixel Relationships (NPR)

NPR의 핵심은 생성 모델의 **업샘플링 층 근처** 구조를 분석하는 것입니다. 일반적으로 생성 모델의 파이프라인은 다음 단계를 따릅니다:[1]

$$
x = \text{up}(x), \quad I = \text{conv}(x)
$$

여기서 $$x \in \mathbb{R}^{l \times W \times l \times H \times C}$$는 업스케일된 피처맵이고, $$I$$는 생성된 이미지입니다.

**NPR 계산 과정**은 다음과 같습니다:[1]

1. 이미지 $$I$$를 $$W \times H$$ 그리드로 분할
2. 각 그리드 $$v_f = \{W_1, ..., W_n\}$$의 원소들 간 관계를 계산:

$$
\hat{u}^c_I = \{W_1 - W_j, ..., W_i - W_j, ..., W_n - W_j\}, \quad 1 \leq j \leq n
$$

3. 뺄셈을 통해 상대적 픽셀 관계를 포착

논문의 설정에서는 $$l = 2$$ (2×2 패치)와 $$j = 1$$을 사용합니다. 이 접근법은 **번역 불변성(translation invariance)** 때문에 작동합니다. 업샘플링으로 생성된 강한 픽셀 상관관계가 CNN 컨볼루션 층을 통과하면서도 유지되며, 이는 생성된 이미지의 국소 픽셀에 구분 가능한 관계로 나타납니다.[1]

#### 모델 구조

감지 모델은 **경량 CNN 네트워크**로 설계되었습니다:[1]

- 컨볼루션 층과 ResNet 블록으로 구성
- **1.44백만 개의 파라미터**
- Adam 옵티마이저 사용 (학습률: $$2 \times 10^{-4}$$, 배치 크기: 32)

***

### 3. 성능 향상 분석

#### 정량적 성능 결과

NPR은 28개 생성 모델 전체에서 **평균 정확도 92.2%**를 달성했습니다. 구체적인 성과:[1]

| 모델 범주 | NPR 정확도 | 이전 최고(Ojha) | 향상도 |
|----------|-----------|--------------|-------|
| ForenSynths GAN | 92.5% | 89.1% | +3.4% |
| 자체 구성 9개 GAN | 93.2% | 77.6% | +15.6% |
| DiffusionForensics | 95.3% | 74.4% | +20.9% |
| Ojha 디퓨전 | 95.2% | 86.9% | +8.3% |
| 자체 구성 디퓨전 | 80.1% | 66.4% | +13.7% |

#### 정성적 분석

Class Activation Map (CAM) 시각화에서 NPR은 다음을 보여줍니다:[1]

- **생성된 이미지**: 국소화된 영역에 집중 (업샘플링 아티팩트가 나타나는 부분)
- **실제 이미지**: 더 광범위한 영역에 활성화

이는 NPR이 생성 과정 특유의 패턴을 포착함을 시사합니다.[1]

***

### 4. 일반화 성능 향상 가능성

#### 크로스 소스 평가

논문의 주요 강점은 **ProGAN으로만 훈련하면서도** 16개의 다른 GAN 모델과 11개의 디퓨전 모델에서 강한 성능을 유지한다는 점입니다. 이는 다음 이유로 가능합니다:[1]

1. **보편적 업샘플링 구조**: 모든 현대적 생성 모델(GAN, 디퓨전 모두)이 업샘플링 층을 사용하기 때문에, NPR이 포착하는 아티팩트는 생성 모델 전반에 공통적입니다.[1]

2. **국소 및 상대적 정보**: NPR은 절대값이 아닌 상대적 픽셀 관계에 초점을 맞추므로, 다양한 업샘플링 기법(최근접 이웃, 쌍선형 등)에서도 견고합니다.[1]

3. **공간 대 주파수**: 공간 도메인의 국소 아티팩트가 주파수 도메인의 전역 아티팩트보다 더 일반화 가능함을 보여줍니다.[1]

#### 하이퍼파라미터 분석

Table 7의 분석에 따르면:[1]

- **패치 크기 l=2**가 최적 (대부분 생성기가 2배 업샘플링 사용)
- **평균 또는 최대값 대체**: 뺄셈 기반 NPR과 비슷한 성능 유지
- 이는 2×2 블록 내 정보만으로도 충분함을 의미합니다.

***

### 5. 모델의 한계

#### 인식된 한계

1. **저해상도 디퓨전 생성 이미지**: 100-200 스텝으로 생성된 이미지에 대한 성능 (Table 5의 자체 구성 데이터셋)이 80.1%로 다소 감소합니다. 이는 저해상도 이미지에서 아티팩트가 덜 명확할 수 있음을 시사합니다.[1]

2. **압축의 영향**: 논문에서 고도로 압축된 딥페이크에 대한 성능 평가가 명시적으로 제시되지 않습니다.

3. **모델 특이성**: BiGAN 같은 특정 생성 모델에서는 다른 모델보다 낮은 성능(87.5%)을 보입니다.[1]

#### 잠재적 약점

1. **계산 독립성**: NPR은 특정 업샘플링 기법에 독립적이라고 주장하지만, 매우 다른 아키텍처(예: VAE 기반 모델)에 대한 테스트가 부족합니다.

2. **데이터 의존성**: 훈련이 ProGAN (근처 이웃 업샘플링)에만 기반되어 있어서, 매우 다른 업샘플링 기법에 대한 일반화가 실제로 얼마나 견고한지 의문이 있습니다.

***

### 6. 향후 연구에 미치는 영향 및 고려 사항

#### 연구 커뮤니티에 미치는 영향

이 연구는 **생성기 아키텍처 분석**이라는 새로운 패러다임을 제시합니다. 기존 딥페이크 검출이 감지 알고리즘 개선에 집중한 반면, 이 논문은 생성 과정 자체의 특성을 활용하는 접근법의 가치를 입증했습니다.[1]

#### 향후 연구 시 고려할 점

1. **다양한 업샘플링 기법 통합 훈련**: 현재 연구는 ProGAN 중심입니다. 여러 업샘플링 기법으로 훈련하면 더욱 견고한 모델이 될 수 있습니다.

2. **압축 및 노이즈 견고성**: 실제 배포 환경에서는 이미지 압축, 필터링, 노이즈가 존재합니다. 이러한 변형에 대한 성능 평가가 필요합니다.

3. **새로운 생성 모델에 대한 사전 학습**: 향후 등장할 새로운 생성 모델들(예: 향상된 디퓨전, 새로운 GAN 변형)에 대해 어떻게 대응할지에 대한 전략이 필요합니다.

4. **하이브리드 접근법**: 주파수 기반 방법과 NPR을 결합하면 상보적 정보로 인한 성능 향상이 가능할 것으로 예상됩니다.

5. **실시간 적용 가능성**: 1.44백만 파라미터 모델은 이미 경량이지만, 모바일이나 엣지 디바이스 배포를 위한 추가 최적화가 고려될 수 있습니다.

6. **해석 가능성 강화**: CAM을 넘어 NPR이 실제로 어떤 유형의 픽셀 관계를 포착하는지에 대한 더 깊은 분석이 도움이 될 것입니다.

***

### 결론

이 논문은 **생성기 아키텍처의 업샘플링 작업**에서 비롯된 국소 픽셀 관계(NPR)를 활용하여 일반화 가능한 딥페이크 검출을 달성했습니다. 28개 생성 모델에서 92.2% 평균 정확도로 기존 방법보다 11.6% 향상된 성능을 보여줍니다. 특히 **주파수 도메인이 아닌 공간 도메인의 국소 정보**가 더 나은 일반화를 제공한다는 통찰은 향후 딥페이크 검출 연구에 중요한 방향을 제시합니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/239cb454-56e1-475a-9c6e-d01e88099ab4/2312.10461v2.pdf)
